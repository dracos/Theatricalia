{% extends 'base.html' %}
{% load prettify %}

{% block title %}Search{% if search %}: &ldquo;{{ search }}&rdquo;{% endif %}{% endblock %}

{% block content %}

<h1>Search{% if search %} for {% ifequal sounds_people 2 %}similar to {% endifequal %}
&ldquo;{{ search }}&rdquo;{% endif %}</h1>

<script type="text/javascript">
if (!window.location.hash)
    start_tab = {% ifequal sounds_people 2 %}2{% else %}{% if plays %}0{% else %}{% if near.geonames or places %}1{% else %}{% if people %}2{% else %}3{% endif %}{% endif %}{% endif %}{% endifequal %};
</script>
<div id="search_tabs">
<ul>
<li{% if not plays %} class="ui-state-disabled"{% endif %}><a href="#search_plays">Plays</a>
<li{% if not near.geonames and not places %} class="ui-state-disabled"{% endif %}><a href="#search_places">Places</a>
<li{% if not people %} class="ui-state-disabled"{% endif %}><a href="#search_people">People</a>
<li{% if not parts %} class="ui-state-disabled"{% endif %}><a href="#search_parts">Parts</a>
</ul>

<div id="search_plays">
{% if plays %}
<h2>Plays</h2>
<ul class="person_list">
{% for play in plays %}
<li><a href="{{ play.get_absolute_url }}">{{ play }}</a>
{% endfor %}
</ul>
{% endif %}
</div>

<div id="search_places">

{% if places or near.geonames %}
<h2>Places</h2>
{% endif %}

{% if places and near.geonames %}
<div id="primary">
{% endif %}

{% if places %}
<p>The following places matched your search:</p>
<ul class="place_list">
{% for place in places %}
<li><a href="{{ place.get_absolute_url }}">{{ place }}</a>
{% endfor %}
</ul>
{% endif %}

{% if places and near.geonames %}
</div>
<div class="secondary">
{% endif %}

{% if near.geonames %}
<p>Or, to see all places around a location, pick from below:
<ul>
{% for place in near.geonames %}
<li><a href="?q={{ place.lat }},{{ place.lng }};name={{ place.name|urlencode }}">{{ place.name|prettify }}</a>{% if place.adminName1 %},
{{ place.adminName1 }}{% endif %}, {{ place.countryName }}
{% endfor %}
</ul>
{% endif %}

{% if places and near.geonames %}
</div>
{% endif %}

</div>

<div id="search_people">
{% if people %}
<h2>People</h2>
{% ifequal sounds_people 1 %}
    <p>We couldn&rsquo;t find any results for &ldquo;{{ search }}&rdquo;. Here are some results that are, or sound, similar:
{% endifequal %}
{% ifequal sounds_people 2 %}
<p>Here are results that are, or sound, similar to &ldquo;{{ search }}&rdquo;:
{% endifequal %}
<ul class="person_list">
{% for person in people %}
<li><a href="{{ person.get_absolute_url }}">{{ person }}</a>
{% endfor %}
</ul>
{% if not request.GET.similar and not sounds_people %}
    {% ifequal people.count 1 %}
        <p>If this isn&rsquo;t who you&rsquo;re looking for, <a href="{% url search %}?q={{ search }};similar=1">see if we have any similar sounding results</a>.
    {% else %}
        <p>If none of these is who you&rsquo;re looking for, <a href="{% url search %}?q={{ search }};similar=1">see if we have any similar sounding results</a>.
    {% endifequal %}
{% endif %}
{% else %}
    {% if search %}
        <p>I&rsquo;m afraid we couldn&rsquo;t find any results. If you&rsquo;re searching for someone, try
        just their first or last name.
    {% endif %}
{% endif %}
</div>

<div id="search_parts">
{% if parts %}
<h2>Parts</h2>
<ul class="person_list">
{% for part in parts %}
<li><a href="{{ part.get_absolute_url }}">{{ part }}</a>
{% endfor %}
</ul>
{% endif %}
</div>

</div>
{% endblock %}
